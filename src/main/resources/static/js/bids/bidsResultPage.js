// Generated by CoffeeScript 1.12.7
(function() {
  var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  this.BidsResultPage = (function(superClass) {
    extend(BidsResultPage, superClass);

    function BidsResultPage() {
      var doorCounter, posquitoRepellerCounter, shutterCounter, thresholdCounter, windowCounter;
      BidsResultPage.__super__.constructor.call(this);
      this.negativeButtonVisibility(false);
      this.positiveButtonText('Zatvori');
      this.bidsCounter = {
        'DOOR': 0,
        'WINDOW': 0,
        'SHUTTER': 0,
        'THRESHOLD': 0,
        'MOSQUITO_REPELLER': 0
      };
      doorCounter = 0;
      windowCounter = 0;
      shutterCounter = 0;
      thresholdCounter = 0;
      posquitoRepellerCounter = 0;
      this.cartList = {};
      this.cartList['DOOR'] = [];
      this.cartList['WINDOW'] = [];
      this.cartList['SHUTTER'] = [];
      this.cartList['THRESHOLD'] = [];
      this.cartList['MOSQUITO_REPELLER'] = [];
    }

    BidsResultPage.prototype.destroy = function() {
      this.cartList = null;
      this.parentPage = null;
      return BidsResultPage.__super__.destroy.call(this);
    };

    BidsResultPage.prototype.show = function(parentPage, parentCartList) {
      this.parentPage = parentPage;
      this.parentCartList = parentCartList;
      this.container.html('');
      if (this.parentCartList['DOOR']) {
        this.bidsCounter['DOOR'] = this.parentCartList['DOOR'].length;
      }
      if (this.parentCartList['WINDOW']) {
        this.bidsCounter['WINDOW'] = this.parentCartList['WINDOW'].length;
      }
      if (this.parentCartList['SHUTTER']) {
        this.bidsCounter['SHUTTER'] = this.parentCartList['SHUTTER'].length;
      }
      if (this.parentCartList['THRESHOLD']) {
        this.bidsCounter['THRESHOLD'] = this.parentCartList['THRESHOLD'].length;
      }
      if (this.parentCartList['MOSQUITO_REPELLER']) {
        this.bidsCounter['MOSQUITO_REPELLER'] = this.parentCartList['MOSQUITO_REPELLER'].length;
      }
      return BidsResultPage.__super__.show.call(this);
    };

    BidsResultPage.prototype.hide = function() {
      return BidsResultPage.__super__.hide.call(this);
    };

    BidsResultPage.prototype._customHTML = function() {
      var doors, html;
      doors = this.parentCartList['DOOR'];
      html = '';
      if (doors.length > 0) {
        html = this._renderDoorSectionHTML(doors);
        return html;
      } else {
        return this._emptyStateHTML();
      }
    };

    BidsResultPage.prototype._emptyStateHTML = function() {
      return "<div class='col-5 m-auto h-75 pt-5 text-center'>Nema porudžbina u korpi :(</div>";
    };

    BidsResultPage.prototype._renderTable = function(item) {
      var dimension;
      dimension = '/';
      if (item.doorWidth && item.doorHeight && item.doorInnerWidth) {
        dimension = item.doorWidth + 'x' + item.doorHeight + 'x' + item.doorInnerWidth;
        return "<tr class='js--bid--row' data-bid-id=" + item.id + " data-bid-type=" + item.bidType + "> <td class='table-text w-15'>" + item.doorSort + "</td> <td class='table-text w-15'>" + item.doorType + "</td> <td class='table-text w-10'>" + item.doorOpenSide + "</td> <td class='table-text w-10'>" + item.doorGlass + "</td> <td class='table-text w-10'>" + dimension + "</td> <td class='table-text w-10'>" + item.doorCount + "</td> <td class='table-text w-5'> <span class='edit-icon js--show--client' data-bid-id=" + item.id + "></span> </td> <td class='table-text w-5'> <span class='remove-icon js--remove--bid' data-bid-id=" + item.id + "></span> </td> </tr>";
      }
    };

    BidsResultPage.prototype._renderDoorSectionHTML = function(items) {
      var html;
      html = '';
      html += this._getSectionNameHTML('Vrata', 'js--door--section');
      html += this._getDoorSectionHTML(items);
      return html;
    };

    BidsResultPage.prototype._getSectionNameHTML = function(sectionName, jsSelector) {
      return "<div class='container " + jsSelector + "'><h4>" + sectionName + "</h4></div> <table class='table mb-0'> <tr> <th class='table-text w-15'>Vrsta</th> <th class='table-text w-15'>Tip</th> <th class='table-text w-10'>Otvor</th> <th class='table-text w-10'>Staklo</th> <th class='table-text w-10'>Dimenzije</th> <th class='table-text w-10'>Količina</th> <th class='table-text w-5'>Izmeni</th> <th class='table-text w-5'>Obriši</th> </tr> </table>";
    };

    BidsResultPage.prototype._getDoorSectionHTML = function(items) {
      var html, i, item, len;
      html = "<table class='table table-striped'>";
      for (i = 0, len = items.length; i < len; i++) {
        item = items[i];
        html += this._renderTable(item);
      }
      html += '</table>';
      return html;
    };

    BidsResultPage.prototype._pageClientEventHandler = function(event) {
      var target;
      target = $(event.target);
      if (closest(target, '.js--remove--bid')) {
        this._removeBid(target);
      }
    };

    BidsResultPage.prototype._removeBid = function(target) {
      var bidId, bidRow, bidType;
      bidId = target.attr('data-bid-id');
      bidRow = $(".js--bid--row[data-bid-id='" + bidId + "']");
      bidType = bidRow.attr('data-bid-type');
      this.bidsCounter[bidType] -= 1;
      if (this.bidsCounter[bidType] <= 0) {
        $('.js--door--section').remove();
      }
      this.parentPage.removeBid(bidId, bidType);
      return bidRow.remove();
    };

    return BidsResultPage;

  })(AbstractDialog);

}).call(this);
