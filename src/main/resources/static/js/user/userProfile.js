// Generated by CoffeeScript 1.12.7
(function() {
  this.UserProfile = (function() {
    function UserProfile() {
      this.container = $('.js--page--container');
      this.loggedUser = null;
      this.editProfilePage = new EditProfileDialog();
      this.clickEvent = this._clickEventHandler.bind(this);
      this.container.on('click', this.clickEvent);
      UserService.loadProfileTemplate(null, this, this._loadProfileTemplateSucess, null);
    }

    UserProfile.prototype.getPageTitle = function() {
      return 'Profile';
    };

    UserProfile.prototype.destroy = function() {
      this.container.off('click', this.clickEvent);
      this.clickEvent = null;
      this.loggedUser = null;
      this.editProfilePage.destroy();
      this.editProfilePage = null;
      return this.container.html('');
    };

    UserProfile.prototype._clickEventHandler = function(event) {
      var element, target;
      target = $(event.target);
      element = target.closest('.js--edit--profile');
      if (element.length !== 0) {
        this.editProfilePage.show(this, this.loggedUser);
      }
    };

    UserProfile.prototype._loadProfileTemplateSucess = function(template) {
      this.container.html(template);
      this.firstname = this.container.find(".js--firstname");
      this.lastname = this.container.find(".js--lastname");
      this.phone = this.container.find(".js--phone");
      this.email = this.container.find(".js--email");
      this.street = this.container.find(".js--street");
      this.city = this.container.find(".js--city");
      this.buildNumber = this.container.find(".js--buildNumber");
      return UserService.getUser(window.loggedUserId, null, this, this._getUserSuccess, null);
    };

    UserProfile.prototype._getUserSuccess = function(user) {
      window.loggedUser = user;
      this.loggedUser = user;
      this.firstname.text(user.firstName);
      this.lastname.text(user.lastName);
      this.phone.text(user.phoneNumber);
      this.email.text(user.email);
      this.street.text(user.street);
      this.city.text(user.city);
      return this.buildNumber.text(user.buildNumber);
    };

    UserProfile.prototype.editProfileDialogSuccess = function(user) {
      this.loggedUser = user;
      return this._getUserSuccess(this.loggedUser);
    };

    return UserProfile;

  })();

}).call(this);
